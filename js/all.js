"use strict";var apiDomain="http://kiwi.ponitor.com.tw",isPreview=!1,apiUrl="";function sendFormData(o){console.log(o);var t=document.getElementById("dataForm"),o=new FormData(t),t=$("#dataForm").attr("method");console.log(t);var a={};o.forEach(function(o,t){a[t]=o});o=JSON.stringify(a);console.log("formfata:"+o),$.ajax({url:"".concat(apiDomain).concat(apiUrl),type:t,dataType:"json",contentType:"application/json; charset=utf-8",data:o}).done(function(o){console.log(o)}).fail(function(o){console.log(o),alert("操作失敗")})}function bindEvent(a){var o=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(o).forEach(function(t){t.addEventListener("submit",function(o){t.checkValidity()?(console.log("OK"),o.preventDefault(),o.stopPropagation(),console.log(isPreview),sendFormData(a)):(o.preventDefault(),o.stopPropagation()),t.classList.add("was-validated")},!1)})}function getUrlQuery(o){var t=location.href,a="";if(-1!=t.indexOf("?"))for(var e=t.split("?")[1].split("&"),n=0;n<=e.length-1;n++)e[n].split("=")[0]==o&&(a=e[n].split("=")[1]);return a}function uploadFile(t){var o=new FormData;o.append("file",t.files[0],"json.png");$.ajax({url:"http://kiwi.ponitor.com.tw/api/v1/file/upload",method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:o}).done(function(o){return t.nextElementSibling.value=JSON.parse(o).data.img,console.log($(".".concat($(t).attr("imgClass")))),$(".".concat($(t).attr("imgClass"))).attr("src",JSON.parse(o).data.img),JSON.parse(o).data.img}).fail(function(o){console.log(o),alert("操作失敗")})}$(document).ready(function(){null==localStorage.getItem("user")&&window.location.pathname.indexOf("login.html")<0&&(window.location.href="login.html"),$("input[type='file']").on("change",function(){console.log("upload file"),uploadFile($(this)[0])}),$("header .logout").on("click",function(){localStorage.removeItem("user"),window.location.href="login.html"})});
//# sourceMappingURL=all.js.map
